# Copyright Â© 2025 Cisco Systems, Inc. and its affiliates.
# All rights reserved.

# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at

#     http://www.apache.org/licenses/LICENSE-2.0

# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.


name: 'Set Version'
description: 'Set version from input or default commit hash'
inputs:
  version:
    description: 'Version string (defaults to git short hash)'
    required: false
outputs:
  version:
    description: 'Final version'
    value: ${{ steps.set_version.outputs.version }}
runs:
  using: 'composite'
  steps:
    - name: Set version
      id: set_version
      shell: bash
      run: |
        if [ -n "${{ inputs.version }}" ]; then
          echo "version=${{ inputs.version }}" >> $GITHUB_OUTPUT
          echo "Using provided version: ${{ inputs.version }}"
        else
          VERSION=$(git rev-parse --short HEAD)
          echo "version=$VERSION" >> $GITHUB_OUTPUT
          echo "Using git commit hash: $VERSION"
        fi